---
title: "Project 2"
author: "Anna Su, Donovan Calvert, Naren Makkapati"
resource_files:
- .Renviron
output:
  html_notebook:
    css: style.css
    theme: united
    code_folding: hide
    toc: yes
    toc_depth: 4
    toc_float: yes
runtime: shiny
---
This is an R Interactive Document, which uses the [R Markdown](http://rmarkdown.rstudio.com/authoring_basics.html) language to generate HTML. For a brief introduction to R Markdown, please review this [video](https://www.youtube.com/watch?v=DNS7i2m4sB0&feature=youtu.be).

#Load Packages
This [code chunk](http://rmarkdown.rstudio.com/authoring_rcodechunks.html) loads the packages required to run the R code in the document.
The last line of this code chunk enables document caching, which is expalined at this [link](http://rmarkdown.rstudio.com/authoring_rcodechunks.html).
```{r set-options, echo=FALSE, cache=FALSE}
options(width = 10000)
```


```{r setup, echo=FALSE}
library(tidyverse)
library(shiny)
library(grid)
library(data.world)
library(DT)
library(shinydashboard)
library(plotly)
library(lubridate)
knitr::opts_chunk$set(echo = TRUE)
```

#Display Session Information
The [sessionInfo() fuction](https://cran.r-project.org/web/packages/sessioninfo/sessioninfo.pdf) queries and prints information about the current R session including  information about packages, and from where they were installed.
```{r}
sessionInfo()
```

#Section for Links
Data.world Project Link: https://data.world/yuchan-su/s18-edv-project-2

GitHub Classroom Repository link: https://github.com/CannataUTDV/s18dvproject1-su-makkapati-calvert

#Create Dataframes
The sourced code below contains Shiny [eventReactive](https://shiny.rstudio.com/reference/shiny/1.0.1/observeEvent.html) code and queries for the IBM Attrition database at data.world. The data is saved in variables as functions that return an R dataframe. These are examples data.world parameterized queries; details for data.world queries can be found at this [link](https://cran.r-project.org/web/packages/data.world/vignettes/query.html). The "?"s in the query are parameters. The parameters are filled in (in order) by the paramQuery$params statement.

```{r}
#since you have two different dataframe...load into source here
source("DataA.R", local = TRUE)
source("DataB.R", local = TRUE)
```

#Retrieve Regions from the IBM Attrition dataset
The following query retrieves the distinct department names from the IBM Attirtion dataset at data.world and saves the department names in the department variable.
```{r}
project <- "https://data.world/yuchan-su/s18-edv-project-2" 
data.world::set_config(cfg_env("DW_API")) 

#query that selects region
departments <- data.world::query(data.world::qry_sql(
 "   
	select distinct department
  from ibm_hr_attrition
 "), 
dataset = project)
```
#Create a Departments Variable
Create a Department variable with a string constructed from the selected deparment in the input$selectDeparatment_1 variable.This Department variable will be used in the title of the ggplot below.

```{r}
Department <- eventReactive(c(input$selectDeparatment_1), { 
  library('stringr')
  str_c(input$selectDeparatment_1, collapse=', ')
})
```

#Create Panel with Select List
The following code creates an input panel for the Interactive Document, which has a [select box](https://shiny.rstudio.com/reference/shiny/latest/selectInput.html) for selecting department (notice - choices is set to the department variable that was loaded by the previous query) For a complete list of Shiny functions, please see this [link](https://shiny.rstudio.com/reference/shiny/latest/).

```{r}
#what panel is this?? The regionselectpanel. So it's the oen taht appears To have all the select TABS. In a way this is a way for people on the website to REDO the query

inputPanel(
  selectInput("selectDeparatment_1", label = "Select Department",choices = departments, multiple=TRUE, selected=c("Sales","Human Resources","Research & Development"))
)
```

#Render and Display the Shipping Costs Histograms

Using [ggplotly](https://www.rdocumentation.org/packages/plotly/versions/4.7.1/topics/ggplotly) and [shinydashborad](https://rstudio.github.io/shinydashboard/structure.html#dynamic-content-1)

```{r}
#show they have four different side 
ui <- dashboardPage( skin = "green",
  dashboardHeader( title = "IBM Human Resources Attrition Data"
  ),
  dashboardSidebar(
    width = 350,
    sidebarMenu(
      menuItem("Monthly Income Histogram", tabName = "histogram", icon = icon("asymmetrik")),
      menuItem("Shipping Costs Density Plot", tabName = "density", icon = icon("asymmetrik")),
      menuItem("Department Age Histogram", tabName = "both", icon = icon("asymmetrik")),
      menuItem("Some boxplot", tabName = "newplot", icon = icon("asymmetrik"))
    )
  ),
  dashboardBody(
    width = 800,
    tabItems(
      # 1. "Monthly Income Histogram" tab content
      tabItem(tabName = "histogram",
        p("This histogram shows the monthly income found in our data, distributed by age."),
        source("Histogram1UI.R",local = TRUE)$value
      ),
      # 2. "Shipping Costs Density Plot" tab content
      tabItem(tabName = "density",
        p("And here."),
        source("Density1UI.R",local = TRUE)$value
      ),
      # 3. "Shipping Costs Histogram and Density Plot" tab content
      tabItem(tabName = "both",
        p("And even here."),
        source("Both1UI.R",local = TRUE)$value
      ),
      # 4. "Sales Histogram" tab content
      tabItem(tabName = "newplot",
        p("And even here."),
        source("NewPlot1UI.R",local = TRUE)$value
      )
      #creating a differ one, tabname is to be unique in this case; then now you ahve ability to have FIVE plots. And then you go and make the server and UI file to change the graphs
    )
  )
)

source("Histogram1Server.R", local = TRUE)
source("Density1Server.R", local = TRUE)
source("Both1Server.R", local = TRUE)
source("NewPlot1Server.R", local = TRUE)

server <- function(input, output) {}

shinyApp(ui, server)

```

#Naren's Test Code
This is a test by Naren. If you see this, it worked.


#Appendix
Data cleaning Code.


